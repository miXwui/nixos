# NixOS Configurations

## Install a specific version of a package

Find details from <https://lazamar.co.uk/nix-versions/> or search the Git repo for the PR/commit.

Then modify `hosts/home.nix` like so:

```nix
let
  old = import (builtins.fetchGit {
    name = "waybar-old";
    url = "https://github.com/NixOS/nixpkgs/";
    ref = "refs/heads/nixpkgs-unstable";
    rev = "db92283eff575ac2a78d7b2d65d2dad4f7acf14a";
  }) { system = "x86_64-linux"; };
in
{
  home.packages = with pkgs; [
    old.waybar
  ]
}
```

## Build ISO

`flake.nix` is set up to use [nixos-generators](https://github.com/nix-community/nixos-generators):

```sh
nix build .#iso
```

[This](https://www.reddit.com/r/NixOS/comments/18gkafh/comment/kd13m58/) also works if added to `flake.nix`:

```nix
{
  nixosConfigurations = {
    live-image = nixpkgs.lib.nixosSystem {
      specialArgs = { inherit inputs; };
      modules = [
        (nixpkgs + "/nixos/modules/installer/cd-dvd/installation-cd-minimal.nix")
        ./hosts/live-image/configuration.nix
        inputs.home-manager.nixosModules.default
        { nixpkgs.overlays = overlays; }
      ];
    };
};
}
```

```sh
nix build .#nixosConfigurations.live-image.config.system.build.isoImage
```
